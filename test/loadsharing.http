# Name: REST Client
# Id: humao.rest-client
# Description: REST Client for Visual Studio Code
# Version: 0.21.3
# Publisher: Huachao Mao
# VS Marketplace Link: https://marketplace.visualstudio.com/items?itemName=humao.rest-client

# You should use environment vars (https://marketplace.visualstudio.com/items?itemName=humao.rest-client#environment-variables) for these
# but you can also set here if needed (just don't check in!)

#@baseUrl = http://localhost:8000

###
# Get list of discovered and configured peers

GET {{baseUrl}}/loadsharing/peers HTTP/1.1

###
# Add a peer to the load sharing group

POST {{baseUrl}}/loadsharing/peers HTTP/1.1
Content-Type: application/json

{
  "host": "openevse-2.local"
}

###
# Add another peer

POST {{baseUrl}}/loadsharing/peers HTTP/1.1
Content-Type: application/json

{
  "host": "openevse-3.local"
}

###
# Add a peer by IP address

POST {{baseUrl}}/loadsharing/peers HTTP/1.1
Content-Type: application/json

{
  "host": "192.168.1.100"
}

###
# Try to add duplicate peer (should fail)

POST {{baseUrl}}/loadsharing/peers HTTP/1.1
Content-Type: application/json

{
  "host": "openevse-2.local"
}

###
# Try to add peer with invalid format (should fail)

POST {{baseUrl}}/loadsharing/peers HTTP/1.1
Content-Type: application/json

{
  "host": "invalid"
}

###
# Try to add peer with missing host parameter (should fail)

POST {{baseUrl}}/loadsharing/peers HTTP/1.1
Content-Type: application/json

{
}

###
# Get updated peer list

GET {{baseUrl}}/loadsharing/peers HTTP/1.1

###
# Trigger on-demand discovery to refresh peer list

POST {{baseUrl}}/loadsharing/discover HTTP/1.1

###
# Get peer list after discovery

GET {{baseUrl}}/loadsharing/peers HTTP/1.1

###
# Remove a peer from the load sharing group

DELETE {{baseUrl}}/loadsharing/peers/openevse-2.local HTTP/1.1

###
# Try to remove a peer that doesn't exist (should fail)

DELETE {{baseUrl}}/loadsharing/peers/nonexistent.local HTTP/1.1

###
# Get peer list after removal

GET {{baseUrl}}/loadsharing/peers HTTP/1.1

###
# Remove another peer

DELETE {{baseUrl}}/loadsharing/peers/openevse-3.local HTTP/1.1

###
# Remove the IP address based peer

DELETE {{baseUrl}}/loadsharing/peers/192.168.1.100 HTTP/1.1

###
# Get final peer list (should only show discovered peers)

GET {{baseUrl}}/loadsharing/peers HTTP/1.1
